<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"> </script>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="">
	<meta name="author" content="">
	<style>
		table {
			font-family: arial, sans-serif;
			border-collapse: collapse;
			width: 100%;
		}

		td,
		th {
			border: 1px solid #dddddd;
			text-align: left;
			padding: 8px;
		}

		tr:nth-child(even) {
			background-color: #dddddd;
		}
	</style>

	<title>VISITOR DETAILS</title>

	<!-- Custom fonts for this template-->
	<div th:replace="admin/common/layout ::links"> </div>



</head>

<body id="page-top" onload="attendancedataget()">
	<div class="card shadow sm-4">
		<!-- Page Wrapper -->
		<div id="wrapper">

			<!-- Sidebar -->
			<div th:replace="admin/common/layout ::side-bar"> </div>
			<!-- End of Sidebar -->

			<!-- Content Wrapper -->
			<div id="content-wrapper" class="d-flex flex-column">

				<!-- Main Content -->
				<div id="content">

					<!-- Topbar -->

					<div th:replace="admin/common/layout ::topbar"> </div>
					<!-- End of Topbar -->

					<!-- Begin Page Content -->
					<div class="container-fluid">

						<!--  $$$$$$$   Jquery Table Start   $$$$$$$  -->
						<div class="card shadow mb-2">
							<div class="col-md-12">
								<div class="row">
									<div align="left" class="container my-2 col-6">
										<h1>Attendance</h1>

									</div>

									<div align="right" class="container my-2 col-6">
										<button type="button" class="btn btn-outline-warning" id='checkin' onclick="checkin(this.id)">Check
											In</button>
										<button type="button" class="btn btn-outline-danger" id='checkout' onclick="checkin(this.id)">Check
											Out</button>
									</div>
									<input type="text" name=" " style="text-align: center;" id="attendInput"
										placeholder="search  names....">
								</div>
							</div>

							<!--<div class="text-center">
									<button class="btn btn-primary btn-md m-2" type="button" id="assign"
										onclick="assignEmployeeDataToExcel()">Assign Visitor
										Info</button></h4>

								</div>-->

						</div>




						<table class="table table-bordered dataTable" width="80%" cellspacing="0" role="grid"
							aria-describedby="dataTable_info" style="width: 100%;" id="attendTable">
							<thread>
								<tr>
									<form id='refresh'>

										<th scope="col">Id</th>
										<th scope="col">Employee Name</th>
										<th scope="col">Email</th>
										<th scope="col">Date</th>

										<th scope="col">Check In</th>
										<th scope="col">Check Out</th>




									</form>
								</tr>
							</thread>
							<tbody id="mytable">

							</tbody>


						</table>
					</div>
				</div>
				<!--  $$$$$$$   Jquery Table End   $$$$$$$  -->


			</div>
			<!-- /.container-fluid -->

		</div>
		<!-- End of Main Content -->



	</div>
	<!-- End of Content Wrapper -->






	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="Admin/js/camera.js"></script>
	<script>
		/* Jquery datatable function start */
		//my table data get function //
		function attendancedataget() {
			//alert('this is table')
			$.ajax({

				type: 'ajax',
				method: 'GET',
				url: "fetch-attendance-list",
				data: {},
				async: false,
				dataType: 'json',

				success: function (data) {
					var a = "";
					//alert('table')
					for (i = 0; i < data.length; i++) {

						a += '<tr>' +

							'<td>' + data[i].userId + '</td>' +
							'<td>' + data[i].employeeName + '</td>' +
							'<td>' + data[i].email + '</td>' +
							'<td>' + data[i].date + '</td>' +
							'<td>' + data[i].checkIn + '</td>' +
							'<td>' + data[i].checkOut + '</td>' +


							//'<td>' + ' <a  id="' + data[i].id + '"  title="Edit" style=color:blue;cursor:pointer;  class=" editvstr fa fa-edit " data-toggle="modal" data-target="#editModal"  > </a>  <a id="' + data[i].id + '" title="Delete" style=color:red;cursor:pointer; class="deletevisitor fa fa-trash" >  </a>' +

							'</tr>';
					}
					$("#mytable").html(a);
				},
				error: function () {

					alert('Data Insert Failed')

				}
			});

		};
		//00000000000000000//
		
		
		function checkin(status) {
			//alert('this is table')
		//	alert(status)
			$.ajax({

				type: 'ajax',
				method: 'GET',
				url: "checkIn",
				data: {status:status},
				

				success: function (data) {
                    console.log(data)
					alert(data)
					attendancedataget()
					//$("#mytable").html(a);
				},
				error: function () {

					alert('Data Insert Failed')
					attendancedataget()
				}
			});

		};
		//check out //
		function checkout() {
			alert('in check out table')
			$.ajax({

				type: 'ajax',
				method: 'GET',
				url: "checkOut",
				data: {},
				

				success: function (data) {

					alert('successfully check out')
					attendancedataget()
					//$("#mytable").html(a);
				},
				error: function () {

					alert('Data Insert Failed')
					attendancedataget()
				}
			});

		};
		////////  *****  search bar by jquery   *****  ////////

		$(document).ready(function () {
			$("#attendInput").on("keyup", function () {
				var value = $(this).val().toLowerCase();
				$("#attendTable tr").filter(function () {
					$(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
				});
			});
		});

	</script>


	<!-- Bootstrap core JavaScript-->
	<div th:replace="admin/common/layout::fotter"> </div>

</body>

</html>