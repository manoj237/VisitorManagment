<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>

	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="">
	<meta name="author" content="">

	<title>USER DETAILS</title>

	<!-- Custom fonts for this template-->
	<div th:replace="admin/common/layout ::links"> </div>

</head>

<body id="page-top" onload="mytabledataget();">
	<div class="card shadow mb-4">
		<!-- Page Wrapper -->
		<div id="wrapper">

			<!-- Sidebar -->
			<div th:replace="admin/common/layout ::side-bar"> </div>
			<!-- End of Sidebar -->

			<!-- Content Wrapper -->
			<div id="content-wrapper" class="d-flex flex-column">

				<!-- Main Content -->
				<div id="content">

					<!-- Topbar -->

					<div th:replace="admin/common/layout ::topbar"> </div>
					<!-- End of Topbar -->

					<!-- Begin Page Content -->
					<div class="container-fluid">

						<!--  $$$$$$$   Jquery Table Start   $$$$$$$  -->

						<div class="card shadow mb-2">
							<div class="col-md-12">
								<div class="row">
									<div align="left" class="container my-2 col-6">
										<h1>USER</h1>
									</div>
									<div align="right" class="container my-2 col-6">
										<button type="button" class="btn btn-outline-warning" data-toggle="modal"
											data-target="#addmodal" ;>ADD USER</button>
									</div>
									<input type="text" name=" " id="userInput" placeholder="search  names....">
								</div>

							</div>
						</div>



						<table class="table table-bordered dataTable" width="80%" cellspacing="0" role="grid"
							aria-describedby="dataTable_info" style="width: 100%;" id="userTable">
							<thread>
								<tr>
									<form id='refresh'>


										<th scope="col">Name</th>
										<th scope="col">Email</th>


										<th scope="col">Mobile</th>
										<th scope="col">Status</th>

										<th scope="col">Role</th>
										<th scope="col">Password</th>

										<th scope="col">Action</th>



									</form>
								</tr>
							</thread>
							<tbody id="mytable">

							</tbody>


						</table>
					</div>
				</div>
				<!--  $$$$$$$   Jquery Table End   $$$$$$$  -->


			</div>
			<!-- /.container-fluid -->

		</div>
		<!-- End of Main Content -->



	</div>
	<!-- End of Content Wrapper -->

	</div>
	<!-- End of Page Wrapper -->

	<!-- Scroll to Top Button-->
	<a class="scroll-to-top rounded" href="#page-top">
		<i class="fas fa-angle-up"></i>
	</a>

	<!--   ************  Add Bootstrap Modal Start  ************   -->


	<!-- Modal -->
	<div class="modal fade" id="addmodal" data-backdrop="static" data-keyboard="false" tabindex="-1"
		aria-labelledby="staticBackdropLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="staticBackdropLabel">ADD USER</h5>
					<b<button type="button" class="btn-close" data-dismiss="modal" aria-label="Close"><span
							aria-hidden="true">&times;</span></button>

				</div>
				<form id="insert">
					<div class="modal-body">
						<div class="form-group">
							<label>Name</label>                      <!-- onkeypress="return /^[A-Z]*$/i.test(event.key)" -->
							<input type="text" class="form-control" name="name" >
						</div>

						<div class="form-group">
							<lable>Email</lable>
							<input type="text" class=form-control name="email" pattern="[^ @]*@[^ @]*" placeholder="Enter Email Id">
						</div>

						<div class="form-group">
							<lable>Mobile</lable>
							<input type="text" class="form-control" name="mobile" placeholder="Mobile Users Number"
								onkeypress="return /^[0-9]*$/i.test(event.key)" maxlength="10" minlength="10" required>
						</div>

						<!--<div class="form-group">
							<lable>Status</lable>
							<input type="text" class="form-control" name="status" placeholder="Status">
						</div>-->

						<div class="form-group">
							<lable>Role</lable>
							<select name="Role" id="role" class="form-control">
								<p style="border: 2px solid orange;">
									<option value="Receptionist">Receptionist</option>
									<option value="Employee">Employee</option>
								</p>
							</select>
						</div>

						<div class="form-group">
							<lable>Password</lable>
							<input type="text" class="form-control" name="password" placeholder="Password">
						</div>

					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Close</button>
						<button type="submit" class="btn btn-outline-success submit">Save</button>
					</div>
				</form>
			</div>
		</div>
	</div>

	<!--   ************  Bootstrap Add Modal end  here  ************   -->

	<!--   ************  Bootstrap Edit Modal Start  here  ************   -->
	<div class="modal fade" id="exampleModal01" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
		aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">

				<div class="modal-header">

					<h5 class="modal-title" id="exampleModalLabel">Edit User </h5>
					<button type="button" class="btn-close" data-dismiss="modal" aria-label="Close"><span
							aria-hidden="true">&times;</span></button>
				</div>
				<form method="GET" id="update1">
					<div class="modal-body">

						<div class="form-group">
							<label>Name</label>
							<input type="text" class="form-control" name="name" id="name1"
								placeholder="Enter User Name">
							<input type="hidden" class="form-control" name="id" id="ids">
						</div>
						<div class="form-group">
							<label>Email</label>
							<input type="text" step="any" class="form-control" name="email" id="email1">

						</div>
						<div class="form-group">
							<label>Mobile</label>
							<input type="text" class="form-control" name="mobile" id="mobile1"
								placeholder="Enter Your Mobile No">
						</div>
						<!--<div class="form-group">
							<label>Status</label>
							<input type="text" class="form-control" name="status" id="status1">
						</div> -->
						<div class="form-group">
							<lable>Role</lable>
							<select name="Role" id="role" class="form-control">
								<p style="border: 2px solid orange;">
									<option value="Receptionist">Receptionist</option>
									<option value="Employee">Employee</option>
								</p>
							</select>
						</div>
						<div class="form-group">
							<label>Password</label>
							<input type="text" class="form-control" name="password" id="password1">
						</div>

					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Close</button>

						<button type="submit" class="btn btn-outline-primary" id="update">Update</button>

					</div>
				</form>
			</div>
		</div>
	</div>
	<!--   ************  Bootstrap Edit Modal End  here  ************   -->


	</div>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

	<script>
		// Function For Juerry Table //
		function mytabledataget() {
			//alert('loading')


			$.ajax({
				type: "ajax",
				method: 'GET',
				url: "/fetch-all-usr-list",

				data: {},
				async: false,
				dataType: 'json',



				success: function (data) {
					//console.log(data);
					//alert('success')


					var a = "";

					for (i = 0; i < data.length; i++) {

						a += '<tr>' +


							'<td>' + data[i].name + '</td>' +
							'<td>' + data[i].email + '</td>' +

							'<td>' + data[i].mobile + '</td>' +
							'<td>' + data[i].status + '</td>' +
							'<td>' + data[i].role + '</td>' +
							'<td>' + data[i].password + '</td>' +
							//'<td>' + ' <a  id="' + data[i].id + '"    class="btn btn-primary editbtn " data-toggle="modal" data-target="#exampleModal01"  >EDIT</a>  <a id="' + data[i].id + '"  class="btn btn-danger deletebtn" > DELETE </a>' +
							'<td>' + ' <a  id="' + data[i].id + '"  /* title="Edit" style=color:blue;cursor:pointer;  class=" editbtn fa fa-edit " data-toggle="modal" data-target="#exampleModal01"  > </a>   <a id="' + data[i].id + '" title="Delete" style=color:red;cursor:pointer; class="deletebtn fa fa-trash" >  </a>' +

							'</tr>';
					}
					$("#mytable").html(a);
				},


				error: function () {

					alert('Data Inserte Failed')
				}




			});
		};



		// Add Function By Jquerry //
		$(document).on('submit', '#insert', function (e) {
			e.preventDefault();

			$.ajax({
				url: "/save-user",
				method: 'POST',
				data: new FormData(this),
				contentType: false,
				processData: false,
				cache: false,
				beforeSend: function () {

					$(".submit").prop('disabled', true);
				},

				success: function (data) {
					alert("Employee Added");
					mytabledataget();
					$(".submit").prop('disabled', false);
					$('#insert')[0].reset();
					$('#addmodal').modal('hide');





				},
				error: function () {
					alert('Email Already Availble');
				}
			});

		});
		//Add Function By Jquerry End//

		// Delete Function By Jquerry Starts//
		$(document).on('click', '.deletebtn', function () {

			var id = this.id;


			alert('Do you want to delete your data??')

			$.ajax({

				type: "GET",
				url: "/deleteusers",
				data: {id: id},
				success: function (data) {

					mytabledataget();

				}
			})
		});


		// Delete Function By Jquerry Ends//

		$(document).on('click', '.editbtn', function () {
			alert('do you want to edit')
			var id = this.id;
			//alert(id)

			$.ajax({

				type: 'ajax',
				method: 'GET',
				url: "/edituser",
				data: {id: id},
				async: false,
				datatype: 'json',

				success: function (data) {
					//alert('editor')

					$("#ids").val(data.id);
					$("#name1").val(data.name);
					$("#email1").val(data.email);
					$("#mobile1").val(data.mobile);
					$("#status1").val(data.status);
					$("#role1").val(data.role);
					$("#password1").val(data.password);
				}
			})
		});

		$("#update").click(function () {

			var form = $("#update1").serialize();
			//	alert(form)
			$.ajax({
				url: "/updateuser",
				type: "GET",
				data: form,

				success: function (data) {
					alert('update successfully done')
					mytabledataget();
				}
			})
		})


		//  ((((((((((((((((((((((((((( Search Bar By Jquery Start )))))))))))))))))))))))))))  //
		$(document).ready(function () {
			$("#userInput").on("keyup", function () {
				var value = $(this).val().toLowerCase();
				$("#userTable tr").filter(function () {
					$(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
				});
			});
		});

	</script>


	<!-- Bootstrap core JavaScript-->
	<div th:replace="admin/common/layout::fotter"> </div>

</body>

</html>