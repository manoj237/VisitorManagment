<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>

	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="">
	<meta name="author" content="">

	<title>MEETING DETAILS</title>

	<!-- Custom fonts for this template-->
	<div th:replace="admin/common/layout ::links"> </div>

</head>

<body id="page-top" onload="assignedData();getTicketCount();">
	<div class="card shadow mb-4">
		<!-- Page Wrapper -->
		<div id="wrapper">

			<!-- Sidebar -->
			<div th:replace="admin/common/layout ::side-bar"> </div>
			<!-- End of Sidebar -->

			<!-- Content Wrapper -->
			<div id="content-wrapper" class="d-flex flex-column">

				<!-- Main Content -->
				<div id="content">

					<!-- Topbar -->

					<div th:replace="admin/common/layout ::topbar"> </div>
					<!-- End of Topbar -->

					<!-- Begin Page Content -->
					<div class="container-fluid">

						<!--  $$$$$$$   Jquery Table Start   $$$$$$$  -->

						<div class="card shadow mb-2">
							<div class="col-md-12">
								<div class="row">
									<div align="center" class="container my-2 col-6">
										<h1>Assigned Data</h1>

									</div>
								</div>
							</div>
						</div>




						<table class="table table-bordered dataTable" width="80%" cellspacing="0" role="grid"
							aria-describedby="dataTable_info" style="width: 100%;" id="datatable-buttons">
							<thread>
								<tr>
									<form id='refresh'>

										<th scope="col">Date</th>
										<th scope="col">Time</th>
										<!-- <th scope="col">Employee Id</th> -->
										<th scope="col">Employee Name</th>
										<th scope="col">Visitor Reason</th>
										<th scope="col">Visitor Name</th>
										<th scope="col">Employee Reason</th>
										<th scope="col">Status</th>
										<th scope="col">Action</th>




									</form>
								</tr>
							</thread>
							<tbody id="mytable">

							</tbody>


						</table>
					</div>
				</div>
				<!--  $$$$$$$   Jquery Table End   $$$$$$$  -->


			</div>
			<!-- /.container-fluid -->

		</div>
		<!-- End of Main Content -->



	</div>
	<!-- End of Content Wrapper -->

	</div>
	<!-- End of Page Wrapper -->

	<!-- Scroll to Top Button-->
	<a class="scroll-to-top rounded" href="#page-top">
		<i class="fas fa-angle-up"></i>
	</a>



	<!--   ************  Bootstrap Edit Modal Start  here  ************   -->
	<div class="modal fade" id="exampleModal01" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
		aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">

				<div class="modal-header">

					<h5 class="modal-title" id="exampleModalLabel">Edit User </h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<form method="GET" id="update2">
					<div class="modal-body">

						<div class="form-group">
							<label>Visitor Name</label>
							<input type="text" class="form-control" name="visname" id="name1">
							<input type="hidden" class="form-control" name="id" id="ids">
							<input type="hidden" class="form-control" name="empname" id="empname12">
							<input type="hidden" class="form-control" name="time" id="time12">
							<input type="hidden" class="form-control" name="empid" id="empid12">
							<input type="hidden" class="form-control" name="recpid" id="recpid12">
							<!--<input type="hidden" class="form-control" name="date" id="date12">-->
						</div>
						<div class="form-group">
							<label>Reason For The Meeting</label>
							<textarea type="text" step="any" class="form-control" name="visreason" id="reason1"
								readonly>
							</textarea>

						</div>

						<div class="form-group">
							<label>Date</label>
							<input type="text" class="form-control" name="date" id="date12">
						</div>
						<div class="form-group">
							<label>Reason For Employee</label>
							<textarea type="text" class="form-control" name="empreason" id="empreason" required>
							</textarea>
						</div>

						<div class="form-group">
							<label>Status</label>
							<select type="text" class="form-control" name="status" id="status" required>
								<option text-color="alert" value="Accept">Accept</option>
								<option value="Reject">Reject</option>
								<option value="Complete">Complete</option>

							</select>
						</div>

					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Close</button>

						<button type="submit" class="btn btn-outline-primary" id="update">Update</button>

					</div>
				</form>
			</div>
		</div>
	</div>
	<!--   ************  Bootstrap Edit Modal End  here  ************   -->


	</div>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

	<script>
		// Function For Juerry Table //
		function assignedData() {
			//	alert('this is table')
			$.ajax({

				type: 'ajax',
				method: 'GET',
				url: "fetch-assigndata-list",
				data: {},
				async: false,
				dataType: 'json',

				success: function (data) {

					var a = "";
					var status = "";
					//alert('table')
					for (i = 0; i < data.length; i++) {
						if (data[i].status == 'Accept') {
							status = '<td class="lead-tag" style="color:orange;"><b>' + data[i].status + '</b></td>'
						} else if (data[i].status == 'Reject') {
							status = '<td class="lead-tag" style="color:red"><b>' + data[i].status + '</b></td>'
						} else if (data[i].status == 'Pending') {
							status = '<td class="lead-tag" style="color:#ff33cc"><b>' + data[i].status + '</b></td>'
						} else if (data[i].status == 'Complete') {
							status = '<td class="lead-tag" style="color:green"><b>' + data[i].status + '</b></td>'
						}
						else {
							status = '<td>' + ' ' + '</td>'
						}
						a += '<tr>' +

							'<td>' + data[i].date + '</td>' +
							'<td>' + data[i].time + '</td>' +

							'<td>' + data[i].empname + ' ' + data[i].empid + '</td>' +
							'<td>' + data[i].visreason + '</td>' +
							'<td>' + data[i].visname + '</td>' +
							'<td>' + data[i].empreason + '</td>' +
							status +

							'<td>' + ' <a  id="' + data[i].id + '"  title="Edit" style=color:blue;cursor:pointer;align:center;  class="fa fa-edit editbtn" data-toggle="modal" data-target="#exampleModal01" > </a>  ' +

							'</tr>';
					}
					$("#mytable").html(a);


				},

				error: function () {

					alert('Data Inserte Failed')

				}
			});

		};

		// Add Function By Jquerry //
		$(document).on('submit', '#insert', function (e) {
			e.preventDefault();

			$.ajax({
				url: "/save-user",
				method: 'POST',
				data: new FormData(this),
				contentType: false,
				processData: false,
				cache: false,
				beforeSend: function () {

					$(".submit").prop('disabled', true);
				},

				success: function (data) {
					alert("Details added successfully");
					mytabledataget();
					$(".submit").prop('disabled', false);
					$('#insert')[0].reset();
					$('#addmodal').modal('hide');





				},
				error: function () {
					alert('Email Already Availble');
				}
			});

		});
		//Add Function By Jquerry End//

		// Delete Function By Jquerry Starts//
		$(document).on('click', '.deletebtn', function () {

			var id = this.id;


			//alert('Do you want to delete your data??')

			$.ajax({

				type: "GET",
				url: "/deleteusers",
				data: {id: id},
				success: function (data) {

					assignedData();

				}
			})
		});


		// Delete Function By Jquerry Ends//

		$(document).on('click', '.editbtn', function () {
			//alert('do you want to edit')
			var id = this.id;
			//alert(id)

			$.ajax({

				type: 'ajax',
				method: 'GET',
				url: "/get-assigned-data-list",
				data: {id: id},
				async: false,
				datatype: 'json',

				success: function (data) {
					//alert('editor')
					//console.log('qqqqqqq' + data.empname);
					$("#ids").val(data.id);
					$("#name1").val(data.visname);
					$("#reason1").val(data.visreason);
					$("#empreason").val(data.empreason);
					$("#time12").val(data.time);
					$("#empname12").val(data.empname);
					$("#recpid12").val(data.recpid);
					$("#date12").val(data.date);
					$("#empid12").val(data.empid);
					$("#status").val(data.status);
					//$("#password1").val(data.password);
				}
			})
		});

		$("#update").click(function () {

			var form = $("#update2").serialize();
			//	alert(form)
			$.ajax({
				url: "/update2-assigned-data",
				type: "GET",
				data: form,

				success: function (data) {
					//alert('update successfully done')
					mytabledataget();
				}
			})
		})

	</script>


	<!-- Bootstrap core JavaScript-->
	<div th:replace="admin/common/layout::fotter"> </div>

</body>

</html>>